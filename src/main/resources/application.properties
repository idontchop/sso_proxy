spring.application.name=sso-proxy

# Database Configuration (H2 for development, change to SQL Server for production)
spring.datasource.url=jdbc:h2:mem:testdb
spring.datasource.driver-class-name=org.h2.Driver
spring.datasource.username=sa
spring.datasource.password=password

# JPA/Hibernate Configuration
spring.jpa.database-platform=org.hibernate.dialect.H2Dialect
spring.jpa.hibernate.ddl-auto=create-drop
spring.jpa.show-sql=true
spring.jpa.format-sql=true

# H2 Console (for development only)
spring.h2.console.enabled=true
spring.h2.console.path=/h2-console

# Logging
logging.level.org.springframework.security=INFO
logging.level.com.idontchop.sso_proxy=INFO

# Server Configuration
server.port=8080

# ============================================
# Spring Cloud Gateway Configuration
# ============================================

# Example Route 1: User Service
# Routes /api/users/** to http://localhost:8082
spring.cloud.gateway.mvc.routes[0].id=user-service
spring.cloud.gateway.mvc.routes[0].uri=http://localhost:8082
spring.cloud.gateway.mvc.routes[0].predicates[0]=Path=/api/users/**
spring.cloud.gateway.mvc.routes[0].filters[0]=AddRequestHeader=X-Gateway, SSO-Proxy
spring.cloud.gateway.mvc.routes[0].filters[1]=AddRequestHeader=X-Forwarded-By, SSO-Proxy

# Example Route 2: Product Service
# Routes /api/products/** to http://localhost:8083
spring.cloud.gateway.mvc.routes[1].id=product-service
spring.cloud.gateway.mvc.routes[1].uri=http://localhost:8083
spring.cloud.gateway.mvc.routes[1].predicates[0]=Path=/api/products/**
spring.cloud.gateway.mvc.routes[1].filters[0]=AddRequestHeader=X-Gateway, SSO-Proxy

# Example Route 3: Order Service with Path Rewriting
# Routes /api/orders/** to http://localhost:8084/order-api/**
# spring.cloud.gateway.mvc.routes[2].id=order-service
# spring.cloud.gateway.mvc.routes[2].uri=http://localhost:8084
# spring.cloud.gateway.mvc.routes[2].predicates[0]=Path=/api/orders/**
# spring.cloud.gateway.mvc.routes[2].filters[0]=RewritePath=/api/orders/(?<segment>.*), /order-api/$\{segment}
# spring.cloud.gateway.mvc.routes[2].filters[1]=AddRequestHeader=X-Gateway, SSO-Proxy

# Gateway Global Configuration
spring.cloud.gateway.mvc.httpclient.connect-timeout=3000
spring.cloud.gateway.mvc.httpclient.response-timeout=5000

# SQL Server Configuration (commented out - uncomment and update for production)
# spring.datasource.url=jdbc:sqlserver://localhost:1433;databaseName=sso_proxy;encrypt=true;trustServerCertificate=true
# spring.datasource.username=your_username
# spring.datasource.password=your_password
# spring.jpa.database-platform=org.hibernate.dialect.SQLServerDialect
